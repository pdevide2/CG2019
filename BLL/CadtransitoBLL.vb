Imports System.DataImports System.Collections.GenericImports DALImports System.Data.CommonImports System.Data.SqlClientPublic Class CadtransitoBLL    Public Enum flagOp        Limpar = 0        Novo = 1        Alterar = 2        Excluir = 3        Consulta = 4        Leitura = 5    End Enum    Public Sub GravarBLL(ByVal acao As Integer, ByVal oTransito As DTO.Cg_transito)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_TRANSITO", DbType.Int32, oTransito.Id_transito))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@NOME_TRANSITO", DbType.String, oTransito.Nome_transito))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@INATIVO", DbType.Boolean, oTransito.Inativo))
        'listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_EMPRESA", DbType.Int32, oTransito.Id_empresa))

        Try            Dim cmd As String            cmd = Nothing            If acao = flagOp.Alterar Then                cmd = "spUpd_Cg_transito"            ElseIf acao = flagOp.Novo Then                cmd = "spIns_Cg_transito"            End If            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirBLL(_KeyId As Integer)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_TRANSITO", DbType.Int32, _KeyId))        Try            Dim cmd As String            cmd = Nothing            cmd = "spDel_Cg_transito"            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    'Public Function PesquisaPorIdModelBLL(ByVal KeyId As Integer, ByVal strTabela As String, colunaId As String) As DTO.Cg_finalidade    '    Dim sql = "SELECT * FROM " & strTabela & " WHERE " & colunaId & " = " & KeyId.ToString    '    Dim dr As SqlDataReader    '    dr = DAL.DALGenerico.ExecutarComando("SQLServer", sql, CommandType.Text, Nothing, DALGenerico.TipoDeComando.ExecuteReader)    '    Dim oModelo As New DTO.Cg_transito    '    If dr.HasRows Then    '        dr.Read()    '        oModelo.Id_transito = CInt(dr.Item("Id_transito"))    '        oModelo.Desc_transito = dr.Item("Desc_transito")    '        oModelo.User_ins = CInt(dr.Item("User_ins"))    '        oModelo.Data_ins = CDate(dr.Item("Data_ins"))    '        oModelo.User_upd = CInt(dr.Item("User_upd"))    '        oModelo.Data_upd = CDate(dr.Item("Data_upd"))    '    Else    '        oModelo.Id_transito = -1    '    End If    '    Return oModelo    'End FunctionEnd Class