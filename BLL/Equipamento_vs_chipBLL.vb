Imports System.DataImports System.Collections.GenericImports DALImports System.Data.CommonImports System.Data.SqlClientPublic Class Equipamento_vs_chipBLLPublic Enum flagOp        Limpar = 0        Novo = 1        Alterar = 2        Excluir = 3        Consulta = 4        Leitura = 5    End Enum    Public Sub GravarBLL(ByVal acao As Integer, ByVal oEquipamento_vs_chip As DTO.Cg_equipamento_vs_chip)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_EQUIPAMENTO",DbType.Int32,oEquipamento_vs_chip.Id_equipamento))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_CHIP",DbType.Int32,oEquipamento_vs_chip.Id_chip))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@USER_UPD",DbType.Int32,oEquipamento_vs_chip.User_upd))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_UPD",DbType.Datetime,oEquipamento_vs_chip.Data_upd))        Try            Dim cmd As String            cmd = Nothing            If acao = flagOp.Alterar Then                cmd = "spUpd_Cg_equipamento_vs_chip"            ElseIf acao = flagOp.Novo Then                cmd = "spIns_Cg_equipamento_vs_chip"            End If            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirBLL(_Id_Equipamento As Integer, _Id_Chip As Integer)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_EQUIPAMENTO", DbType.Int32, _Id_Equipamento))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_CHIP", DbType.Int32, _Id_Chip))        Try            Dim cmd As String            cmd = Nothing            cmd = "spDel_Cg_equipamento_vs_chip"            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirTudoBLL(_Id_Equipamento As Integer)        Try            Dim cmd As String            cmd = Nothing            cmd = "DELETE FROM CG_EQUIPAMENTO_VS_CHIP WHERE ID_EQUIPAMENTO = " & _Id_Equipamento.ToString            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.Text, Nothing, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Function PesquisaPorIdModelBLL(ByVal KeyId As Integer, ByVal strTabela As String, colunaId As String) As DTO.Cg_equipamento_vs_chip        Dim sql = "SELECT * FROM " & strTabela & " WHERE " & colunaId & " = " & KeyId.ToString        Dim dr As SqlDataReader        dr = DAL.DALGenerico.ExecutarComando("SQLServer", sql, CommandType.Text, Nothing, DALGenerico.TipoDeComando.ExecuteReader)        Dim oModelo As New DTO.Cg_equipamento_vs_chip        If dr.HasRows Then            dr.Read()        oModelo.Id_equipamento = CInt(dr.Item("Id_equipamento"))        oModelo.Id_chip = CInt(dr.Item("Id_chip"))        oModelo.User_upd = CInt(dr.Item("User_upd"))        oModelo.Data_upd = CDate(dr.Item("Data_upd"))        Else        oModelo.Id_equipamento = -1        oModelo.Id_chip = -1        End If        Return oModelo    End FunctionEnd Class