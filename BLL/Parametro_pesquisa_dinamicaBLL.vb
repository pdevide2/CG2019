Imports System.DataImports System.Collections.GenericImports DALImports System.Data.CommonImports System.Data.SqlClientPublic Class Parametro_pesquisa_dinamicaBLLPublic Enum flagOp        Limpar = 0        Novo = 1        Alterar = 2        Excluir = 3        Consulta = 4        Leitura = 5    End Enum    Public Sub GravarBLL(ByVal acao As Integer, ByVal oParametro_pesquisa_dinamica As DTO.Cg_parametro_pesquisa_dinamica)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TABELA",DbType.String,oParametro_pesquisa_dinamica.Tabela))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@COLUNA",DbType.String,oParametro_pesquisa_dinamica.Coluna))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@IDCOLUNA",DbType.Int32,oParametro_pesquisa_dinamica.Idcoluna))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ORDERCOL",DbType.Int32,oParametro_pesquisa_dinamica.Ordercol))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CHAVE",DbType.Boolean,oParametro_pesquisa_dinamica.Chave))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TIPODADO",DbType.String,oParametro_pesquisa_dinamica.Tipodado))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@COLUNA_FILTRO",DbType.Boolean,oParametro_pesquisa_dinamica.Coluna_filtro))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@APELIDO_COLUNA",DbType.String,oParametro_pesquisa_dinamica.Apelido_coluna))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@MOSTRA_COLUNA",DbType.Boolean,oParametro_pesquisa_dinamica.Mostra_coluna))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@COLUNA_FILTRO_INICIAL",DbType.Boolean,oParametro_pesquisa_dinamica.Coluna_filtro_inicial))        Try            Dim cmd As String            cmd = Nothing            If acao = flagOp.Alterar Then                cmd = "spUpd_Cg_parametro_pesquisa_dinamica"            ElseIf acao = flagOp.Novo Then                cmd = "spIns_Cg_parametro_pesquisa_dinamica"            End If            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirBLL(_KeyId As Integer)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TABELA",DbType.String,_KeyId))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@COLUNA",DbType.String,_KeyId))        Try            Dim cmd As String            cmd = Nothing            cmd = "spDel_Cg_parametro_pesquisa_dinamica"            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Function PesquisaPorIdModelBLL(ByVal KeyId As Integer, ByVal strTabela As String, colunaId As String) As DTO.Cg_parametro_pesquisa_dinamica        Dim sql = "SELECT * FROM " & strTabela & " WHERE " & colunaId & " = " & KeyId.ToString        Dim dr As SqlDataReader        dr = DAL.DALGenerico.ExecutarComando("SQLServer", sql, CommandType.Text, Nothing, DALGenerico.TipoDeComando.ExecuteReader)        Dim oModelo As New DTO.Cg_parametro_pesquisa_dinamica        If dr.HasRows Then            dr.Read()        oModelo.Tabela = dr.Item("Tabela")        oModelo.Coluna = dr.Item("Coluna")        oModelo.Idcoluna = CInt(dr.Item("Idcoluna"))        oModelo.Ordercol = CInt(dr.Item("Ordercol"))        oModelo.Chave = CBool(dr.Item("Chave"))        oModelo.Tipodado = dr.Item("Tipodado")        oModelo.Coluna_filtro = CBool(dr.Item("Coluna_filtro"))        oModelo.Apelido_coluna = dr.Item("Apelido_coluna")        oModelo.Mostra_coluna = CBool(dr.Item("Mostra_coluna"))        oModelo.Coluna_filtro_inicial = CBool(dr.Item("Coluna_filtro_inicial"))        Else        oModelo.Tabela = -1        oModelo.Coluna = -1        End If        Return oModelo    End FunctionEnd Class