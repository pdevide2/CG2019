'********************************************************'* Movimento_chipBLL'* Classe BLL do cadastro de Movimentação de Estoque de'*                  Chips (SIM)'* PAULO EDUARDO DEVIDE'* 30-JUL-2016'*'* Métodos:'* GravarBLL()'* ExcluirBLL()'* PesquisaPorIdModelBLL()'*' ********************************************************Imports System.DataImports System.Collections.GenericImports DALImports System.Data.CommonImports System.Data.SqlClientPublic Class Movimento_chip_inativoBLL    Public Enum flagOp        Limpar = 0        Novo = 1        Alterar = 2        Excluir = 3        Consulta = 4        Leitura = 5    End Enum    Public Sub GravarBLL(ByVal acao As Integer, ByVal oMovimento_chip As DTO.Cg_movimento_chip_inativo)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_ROMANEIO", DbType.Int32, oMovimento_chip.Id_romaneio))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_MOVTO", DbType.DateTime, oMovimento_chip.Data_movto))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_RESPONSAVEL", DbType.Int32, oMovimento_chip.Id_responsavel))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_LOJA_ORIGEM", DbType.Int32, oMovimento_chip.Id_loja_origem))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_LOJA_DESTINO", DbType.Int32, oMovimento_chip.Id_loja_destino))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TIPO_OP", DbType.String, oMovimento_chip.Tipo_op))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@USER_INS", DbType.Int32, oMovimento_chip.User_ins))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_INS", DbType.DateTime, oMovimento_chip.Data_ins))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@USER_UPD", DbType.Int32, oMovimento_chip.User_upd))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_UPD", DbType.DateTime, oMovimento_chip.Data_upd))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@QTD_RECEBIDA", DbType.Int32, oMovimento_chip.Qtd_recebida))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@QTD_TOTAL", DbType.Int32, oMovimento_chip.Qtd_total))        Try            Dim cmd As String            cmd = Nothing            If acao = flagOp.Alterar Then                cmd = "spUpd_Cg_movimento_chip_inativo"            ElseIf acao = flagOp.Novo Then                cmd = "spIns_Cg_movimento_chip_inativo"            End If            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirBLL(_KeyId As Integer)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_ROMANEIO", DbType.Int32, _KeyId))        Try            Dim cmd As String            cmd = Nothing            cmd = "spDel_Cg_movimento_chip_inativo"            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Function PesquisaPorIdModelBLL(ByVal KeyId As Integer, ByVal strTabela As String, colunaId As String) As DTO.Cg_movimento_chip        Dim sql = "SELECT * FROM " & strTabela & " WHERE " & colunaId & " = " & KeyId.ToString        Dim dr As SqlDataReader        dr = DAL.DALGenerico.ExecutarComando("SQLServer", sql, CommandType.Text, Nothing, DALGenerico.TipoDeComando.ExecuteReader)        Dim oModelo As New DTO.Cg_movimento_chip        If dr.HasRows Then            dr.Read()            oModelo.Id_romaneio = CInt(dr.Item("Id_romaneio"))            oModelo.Data_movto = CDate(dr.Item("Data_movto"))            oModelo.Id_responsavel = CInt(dr.Item("Id_responsavel"))            oModelo.Id_loja_origem = CInt(dr.Item("Id_loja_origem"))            oModelo.Id_loja_destino = CInt(dr.Item("Id_loja_destino"))            oModelo.Tipo_op = dr.Item("Tipo_op")            oModelo.User_ins = CInt(dr.Item("User_ins"))            oModelo.Data_ins = CDate(dr.Item("Data_ins"))            oModelo.User_upd = CInt(dr.Item("User_upd"))            oModelo.Data_upd = CDate(dr.Item("Data_upd"))        Else            oModelo.Id_romaneio = -1        End If        Return oModelo    End FunctionEnd Class