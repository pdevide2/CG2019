Imports System.DataImports System.Collections.GenericImports DALImports System.Data.CommonImports System.Data.SqlClientPublic Class Tabela_servicos_fornecedorBLLPublic Enum flagOp        Limpar = 0        Novo = 1        Alterar = 2        Excluir = 3        Consulta = 4        Leitura = 5    End Enum    Public Sub GravarBLL(ByVal acao As Integer, ByVal oTabela_servicos_fornecedor As DTO.Cg_tabela_servicos_fornecedor)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_FORNECEDOR",DbType.Int32,oTabela_servicos_fornecedor.Id_fornecedor))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_TABELA",DbType.String,oTabela_servicos_fornecedor.Id_tabela))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@PRECO",DbType.Decimal,oTabela_servicos_fornecedor.Preco))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_ITEM",DbType.String,oTabela_servicos_fornecedor.Id_item))        Try            Dim cmd As String            cmd = Nothing            If acao = flagOp.Alterar Then                cmd = "spUpd_Cg_tabela_servicos_fornecedor"            ElseIf acao = flagOp.Novo Then                cmd = "spIns_Cg_tabela_servicos_fornecedor"            End If            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirBLL(_KeyId As Integer)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_ITEM",DbType.String,_KeyId))        Try            Dim cmd As String            cmd = Nothing            cmd = "spDel_Cg_tabela_servicos_fornecedor"            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Function PesquisaPorIdModelBLL(ByVal KeyId As Integer, ByVal strTabela As String, colunaId As String) As DTO.Cg_tabela_servicos_fornecedor        Dim sql = "SELECT * FROM " & strTabela & " WHERE " & colunaId & " = " & KeyId.ToString        Dim dr As SqlDataReader        dr = DAL.DALGenerico.ExecutarComando("SQLServer", sql, CommandType.Text, Nothing, DALGenerico.TipoDeComando.ExecuteReader)        Dim oModelo As New DTO.Cg_tabela_servicos_fornecedor        If dr.HasRows Then            dr.Read()        oModelo.Id_fornecedor = CInt(dr.Item("Id_fornecedor"))        oModelo.Id_tabela = dr.Item("Id_tabela")        oModelo.Preco = CDec(dr.Item("Preco"))        oModelo.Id_item = dr.Item("Id_item")        Else        oModelo.Id_item = -1        End If        Return oModelo    End FunctionEnd Class