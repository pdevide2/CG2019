Imports System.DataImports System.Collections.GenericImports DALImports System.Data.CommonImports System.Data.SqlClientPublic Class ClienteBLLPublic Enum flagOp        Limpar = 0        Novo = 1        Alterar = 2        Excluir = 3        Consulta = 4        Leitura = 5    End Enum    Public Sub GravarBLL(ByVal acao As Integer, ByVal oCliente As DTO.Cg_cliente)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_CLIENTE",DbType.Int32,oCliente.Id_cliente))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@SIGLA",DbType.String,oCliente.Sigla))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@NOME",DbType.String,oCliente.Nome))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CEP",DbType.String,oCliente.Cep))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ENDERECO",DbType.String,oCliente.Endereco))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@COMPLEMENTO",DbType.String,oCliente.Complemento))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CIDADE",DbType.String,oCliente.Cidade))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@BAIRRO",DbType.String,oCliente.Bairro))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@UF",DbType.String,oCliente.Uf))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@EMAIL",DbType.String,oCliente.Email))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TELEFONE1",DbType.String,oCliente.Telefone1))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CONTATO1",DbType.String,oCliente.Contato1))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TELEFONE2",DbType.String,oCliente.Telefone2))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CONTATO2",DbType.String,oCliente.Contato2))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TELEFONE3",DbType.String,oCliente.Telefone3))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CONTATO3",DbType.String,oCliente.Contato3))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TELEFONE4",DbType.String,oCliente.Telefone4))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CONTATO4",DbType.String,oCliente.Contato4))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@OBS",DbType.String,oCliente.Obs))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CADASTRO",DbType.Datetime,oCliente.Cadastro))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ULTIMA_ATUALIZACAO",DbType.Datetime,oCliente.Ultima_atualizacao))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_EMPRESA",DbType.Int32,oCliente.Id_empresa))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@PFPJ", DbType.Int32, oCliente.PfPj))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CPF_CNPJ", DbType.String, oCliente.CpfCnpj))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@RG_IE", DbType.String, oCliente.RgIe))        Try            Dim cmd As String            cmd = Nothing            If acao = flagOp.Alterar Then                cmd = "spUpd_Cg_cliente"            ElseIf acao = flagOp.Novo Then                cmd = "spIns_Cg_cliente"            End If            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirBLL(_KeyId As Integer)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_CLIENTE",DbType.Int32,_KeyId))        Try            Dim cmd As String            cmd = Nothing            cmd = "spDel_Cg_cliente"            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Function PesquisaPorIdModelBLL(ByVal KeyId As Integer, ByVal strTabela As String, colunaId As String) As DTO.Cg_cliente        Dim sql = "SELECT * FROM " & strTabela & " WHERE " & colunaId & " = " & KeyId.ToString        Dim dr As SqlDataReader        dr = DAL.DALGenerico.ExecutarComando("SQLServer", sql, CommandType.Text, Nothing, DALGenerico.TipoDeComando.ExecuteReader)        Dim oModelo As New DTO.Cg_cliente        If dr.HasRows Then            dr.Read()        oModelo.Id_cliente = CInt(dr.Item("Id_cliente"))        oModelo.Sigla = dr.Item("Sigla")        oModelo.Nome = dr.Item("Nome")        oModelo.Cep = dr.Item("Cep")        oModelo.Endereco = dr.Item("Endereco")        oModelo.Complemento = dr.Item("Complemento")        oModelo.Cidade = dr.Item("Cidade")        oModelo.Bairro = dr.Item("Bairro")        oModelo.Uf = dr.Item("Uf")        oModelo.Email = dr.Item("Email")        oModelo.Telefone1 = dr.Item("Telefone1")        oModelo.Contato1 = dr.Item("Contato1")        oModelo.Telefone2 = dr.Item("Telefone2")        oModelo.Contato2 = dr.Item("Contato2")        oModelo.Telefone3 = dr.Item("Telefone3")        oModelo.Contato3 = dr.Item("Contato3")        oModelo.Telefone4 = dr.Item("Telefone4")        oModelo.Contato4 = dr.Item("Contato4")        oModelo.Obs = dr.Item("Obs")        oModelo.Cadastro = CDate(dr.Item("Cadastro"))        oModelo.Ultima_atualizacao = CDate(dr.Item("Ultima_atualizacao"))        oModelo.Id_empresa = CInt(dr.Item("Id_empresa"))        Else        oModelo.Id_cliente = -1        End If        Return oModelo    End FunctionEnd Class