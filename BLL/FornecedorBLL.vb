'********************************************************'* FornecedorBLL'* Classe BLL do cadastro de Usuarios'* PAULO EDUARDO DEVIDE'* 30-JUL-2016'*'* Métodos:'* GravarBLL()'* ExcluirBLL()'* PesquisaPorIdModelBLL()'*' ********************************************************Imports System.DataImports System.Collections.GenericImports DALImports System.Data.CommonImports System.Data.SqlClientPublic Class FornecedorBLL    Public Enum flagOp        Limpar = 0        Novo = 1        Alterar = 2        Excluir = 3        Consulta = 4        Leitura = 5    End Enum    Public Sub GravarBLL(ByVal acao As Integer, ByVal oFornecedor As DTO.Cg_fornecedor)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_FORNECEDOR", DbType.Int32, oFornecedor.Id_fornecedor))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@SIGLA", DbType.String, oFornecedor.Sigla))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@UTILIZA_NFTS", DbType.Boolean, oFornecedor.Utiliza_nfts))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@NOME", DbType.String, oFornecedor.Nome))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CEP", DbType.String, oFornecedor.Cep))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ENDERECO", DbType.String, oFornecedor.Endereco))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@COMPLEMENTO", DbType.String, oFornecedor.Complemento))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CIDADE", DbType.String, oFornecedor.Cidade))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@BAIRRO", DbType.String, oFornecedor.Bairro))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@UF", DbType.String, oFornecedor.Uf))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@EMAIL", DbType.String, oFornecedor.Email))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TELEFONE", DbType.String, oFornecedor.Telefone))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@CONTATO", DbType.String, oFornecedor.Contato))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@WHATSAPP", DbType.String, oFornecedor.Whatsapp))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_TIPO_SERVICO", DbType.Int32, oFornecedor.Id_tipo_servico))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@OBS", DbType.String, oFornecedor.Obs))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@USER_INS", DbType.Int32, oFornecedor.User_ins))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_INS", DbType.DateTime, oFornecedor.Data_ins))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@USER_UPD", DbType.Int32, oFornecedor.User_upd))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_UPD", DbType.DateTime, oFornecedor.Data_upd))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@GARANTIA_AQUISICAO", DbType.Int32, oFornecedor.Garantia_Aquisicao))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@GARANTIA_ASSISTENCIA", DbType.Int32, oFornecedor.Garantia_Assistencia))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_EMPRESA", DbType.Int32, oFornecedor.Id_empresa))        Try            Dim cmd As String            cmd = Nothing            If acao = flagOp.Alterar Then                cmd = "spUpd_Cg_fornecedor"            ElseIf acao = flagOp.Novo Then                cmd = "spIns_Cg_fornecedor"            End If            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirBLL(_KeyId As Integer)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_FORNECEDOR", DbType.Int32, _KeyId))        Try            Dim cmd As String            cmd = Nothing            cmd = "spDel_Cg_fornecedor"            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Function PesquisaPorIdModelBLL(ByVal KeyId As Integer, ByVal strTabela As String, colunaId As String) As DTO.Cg_fornecedor        Dim sql = "SELECT * FROM " & strTabela & " WHERE " & colunaId & " = " & KeyId.ToString        Dim dr As SqlDataReader        dr = DAL.DALGenerico.ExecutarComando("SQLServer", sql, CommandType.Text, Nothing, DALGenerico.TipoDeComando.ExecuteReader)        Dim oModelo As New DTO.Cg_fornecedor        If dr.HasRows Then            dr.Read()            oModelo.Id_fornecedor = CInt(dr.Item("Id_fornecedor"))            oModelo.Sigla = dr.Item("Sigla")            oModelo.Utiliza_nfts = CBool(dr.Item("Utiliza_nfts"))            oModelo.Nome = dr.Item("Nome")            oModelo.Cep = dr.Item("Cep")            oModelo.Endereco = dr.Item("Endereco")            oModelo.Complemento = dr.Item("Complemento")            oModelo.Cidade = dr.Item("Cidade")            oModelo.Bairro = dr.Item("Bairro")            oModelo.Uf = dr.Item("Uf")            oModelo.Email = dr.Item("Email")            oModelo.Telefone = dr.Item("Telefone")            oModelo.Contato = dr.Item("Contato")            oModelo.Whatsapp = dr.Item("Whatsapp")            oModelo.Id_tipo_servico = CInt(dr.Item("Id_tipo_servico"))            oModelo.Obs = dr.Item("Obs")            oModelo.User_ins = CInt(dr.Item("User_ins"))            oModelo.Data_ins = CDate(dr.Item("Data_ins"))            oModelo.User_upd = CInt(dr.Item("User_upd"))            oModelo.Data_upd = CDate(dr.Item("Data_upd"))        Else            oModelo.Id_fornecedor = -1        End If        Return oModelo    End FunctionEnd Class