Imports System.DataImports System.Collections.GenericImports DALImports System.Data.CommonImports System.Data.SqlClientPublic Class Pedido_compra_pecaBLLPublic Enum flagOp        Limpar = 0        Novo = 1        Alterar = 2        Excluir = 3        Consulta = 4        Leitura = 5    End Enum    Public Sub GravarBLL(ByVal acao As Integer, ByVal oPedido_compra_peca As DTO.Cg_pedido_compra_peca)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_PEDIDO",DbType.Int32,oPedido_compra_peca.Id_pedido))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@TIPO_PEDIDO",DbType.String,oPedido_compra_peca.Tipo_pedido))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@STATUS_PEDIDO",DbType.String,oPedido_compra_peca.Status_pedido))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_FORNECEDOR",DbType.Int32,oPedido_compra_peca.Id_fornecedor))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_COMPRADOR",DbType.Int32,oPedido_compra_peca.Id_comprador))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_COMPRA",DbType.Datetime,oPedido_compra_peca.Data_compra))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@PREVISAO_ENTREGA",DbType.Datetime,oPedido_compra_peca.Previsao_entrega))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_RECEBIMENTO",DbType.Datetime,oPedido_compra_peca.Data_recebimento))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@OBS_PEDIDO",DbType.String,oPedido_compra_peca.Obs_pedido))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@USER_INS",DbType.Int32,oPedido_compra_peca.User_ins))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_INS",DbType.Datetime,oPedido_compra_peca.Data_ins))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@USER_UPD",DbType.Int32,oPedido_compra_peca.User_upd))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@DATA_UPD",DbType.Datetime,oPedido_compra_peca.Data_upd))        listaParametros.Add(DAL.DALGenerico.CriarParametro("@QTD_TOTAL", DbType.Int32, oPedido_compra_peca.Qtd_total))        Try            Dim cmd As String            cmd = Nothing            If acao = flagOp.Alterar Then                cmd = "spUpd_Cg_pedido_compra_peca"            ElseIf acao = flagOp.Novo Then                cmd = "spIns_Cg_pedido_compra_peca"            End If            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Sub ExcluirBLL(_KeyId As Integer)        Dim listaParametros As New List(Of DbParameter)        listaParametros.Add(DAL.DALGenerico.CriarParametro("@ID_PEDIDO",DbType.Int32,_KeyId))        Try            Dim cmd As String            cmd = Nothing            cmd = "spDel_Cg_pedido_compra_peca"            DAL.DALGenerico.ExecutarComando("SQLServer", cmd, CommandType.StoredProcedure, listaParametros, DAL.DALGenerico.TipoDeComando.ExecuteNonQuery)        Catch ex As Exception            Throw ex        End Try    End Sub    Public Function PesquisaPorIdModelBLL(ByVal KeyId As Integer, ByVal strTabela As String, colunaId As String) As DTO.Cg_pedido_compra_peca        Dim sql = "SELECT * FROM " & strTabela & " WHERE " & colunaId & " = " & KeyId.ToString        Dim dr As SqlDataReader        dr = DAL.DALGenerico.ExecutarComando("SQLServer", sql, CommandType.Text, Nothing, DALGenerico.TipoDeComando.ExecuteReader)        Dim oModelo As New DTO.Cg_pedido_compra_peca        If dr.HasRows Then            dr.Read()        oModelo.Id_pedido = CInt(dr.Item("Id_pedido"))        oModelo.Tipo_pedido = dr.Item("Tipo_pedido")        oModelo.Status_pedido = dr.Item("Status_pedido")        oModelo.Id_fornecedor = CInt(dr.Item("Id_fornecedor"))        oModelo.Id_comprador = CInt(dr.Item("Id_comprador"))        oModelo.Data_compra = CDate(dr.Item("Data_compra"))        oModelo.Previsao_entrega = CDate(dr.Item("Previsao_entrega"))        oModelo.Data_recebimento = CDate(dr.Item("Data_recebimento"))        oModelo.Obs_pedido = dr.Item("Obs_pedido")        oModelo.User_ins = CInt(dr.Item("User_ins"))        oModelo.Data_ins = CDate(dr.Item("Data_ins"))        oModelo.User_upd = CInt(dr.Item("User_upd"))        oModelo.Data_upd = CDate(dr.Item("Data_upd"))        oModelo.Romaneio_estoque = CInt(dr.Item("Romaneio_estoque"))        oModelo.Qtd_total = CInt(dr.Item("Qtd_total"))        oModelo.Qtd_recebida = CInt(dr.Item("Qtd_recebida"))        Else        oModelo.Id_pedido = -1        End If        Return oModelo    End FunctionEnd Class