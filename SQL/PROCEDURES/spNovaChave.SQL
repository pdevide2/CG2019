create procedure spNovaChave 
@TABELA VARCHAR(50) 
AS
BEGIN

	SET NOCOUNT ON
	DECLARE @KEYVALUE INT

	SELECT @KEYVALUE = ISNULL(KEYID,0) + 1 
	FROM [dbo].[CG_SEQUENCIAL] 
	WHERE TABELA = @TABELA

	IF @@ROWCOUNT > 0
	BEGIN
		UPDATE [dbo].[CG_SEQUENCIAL] 
		SET KEYID = @KEYVALUE 
		WHERE TABELA = @TABELA
	END
	ELSE 
	BEGIN
		SET @KEYVALUE = -1
	END

	SELECT @KEYVALUE KEYID
	SET NOCOUNT OFF

END